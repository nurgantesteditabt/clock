<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üí£ Minesweeper</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Unbounded:wght@200..900&display=swap');

:root{
  --bg:#0e1024;
  --panel:#1a1e40;
  --cell:#2b2f63;
  --cell-open:#40458c;
  --accent:#6cf;
  --danger:#ff4d4d;
  --success:#4caf50;
}

*{
  box-sizing:border-box;
  font-family:"Unbounded", sans-serif;
  -webkit-tap-highlight-color:transparent;
}

body{
  margin:0;
  background:radial-gradient(circle at top,var(--panel),var(--bg));
  color:#fff;
  height:100vh;
  overflow:hidden;
}

/* üîù NAV BAR */
.navbar{
  position:fixed;
  top:0;
  left:0;
  right:0;
  height:64px;
  background:rgba(0,0,0,.35);
  backdrop-filter:blur(10px);
  display:flex;
  align-items:center;
  justify-content:space-around;
  z-index:10;
}

.counter{
  background:#000;
  padding:6px 12px;
  border-radius:10px;
  font-weight:600;
  color:var(--accent);
}

.face{
  font-size:26px;
}

/* üìú CONTENT */
.content{
  position:absolute;
  top:64px;
  bottom:0;
  left:0;
  right:0;
  overflow:auto;
  padding:10px;
}

/* üéö LEVEL BUTTONS */
.controls{
  display:flex;
  gap:8px;
  margin-bottom:10px;
  flex-wrap:wrap;
}

button{
  background:var(--accent);
  border:none;
  border-radius:10px;
  padding:8px 14px;
  font-weight:600;
  cursor:pointer;
}

button.done{
  background:var(--success);
  color:#000;
}

/* üß© GRID WRAPPER */
.grid-wrapper{
  overflow:auto;
  max-width:100%;
}

/* üß© GRID */
.grid{
  display:grid;
  gap:4px;
}

/* üü¶ CELL */
.cell{
  width:32px;
  height:32px;
  background:linear-gradient(145deg,#343a7a,#242861);
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  user-select:none;
  touch-action:manipulation;
}

.cell.open{background:var(--cell-open)}
.cell.mine{background:var(--danger)}
.cell.flag{color:gold}

/* üî¢ NUM COLORS */
.n1{color:#4fc3ff}
.n2{color:#4cff4c}
.n3{color:#ff4c4c}
.n4{color:#5fa8ff}
.n5{color:#c68642}
.n6{color:#9b59b6}
.n7{color:#000}
.n8{color:#ccc}

/* üì± MOBILE SCALE */
@media(max-width:600px){
  .cell{
    width:8vw;
    height:8vw;
    max-width:34px;
    max-height:34px;
    font-size:3.8vw;
  }
}
</style>
</head>

<body>

<div class="navbar">
  <div class="counter" id="mines">üí£ 0</div>
  <div class="face" id="face">üôÇ</div>
  <div class="counter" id="time">‚è± 0</div>
</div>

<div class="content">

  <div class="controls">
    <button id="b1">–õ—ë–≥–∫–∏–π</button>
    <button id="b2">–°–ª–æ–∂–Ω—ã–π</button>
    <button id="b3">–•–∞—Ä–¥–∫–æ—Ä</button>
  </div>

  <div class="grid-wrapper">
    <div class="grid" id="grid"></div>
  </div>

</div>

<script>
  const levels = [
    { s:10, m:0.12, safe:false }, // –õ—ë–≥–∫–∏–π
      { s:22, m:0.05, safe:true  }, // –°–ª–æ–∂–Ω—ã–π
        { s:50, m:0.05, safe:true  }  // –•–∞—Ä–¥–∫–æ—Ä
        ];

        let level=0, size, minesCount;
        let grid=[], opened=0, flags=0;
        let gameOver=false, timer=0, interval;
        let firstClick=true;

        const gridEl = document.getElementById("grid");

        function start(l){
          level=l;
            clearInterval(interval);

              size = levels[level].s;
                minesCount = Math.floor(size*size*levels[level].m);

                  grid=[]; opened=0; flags=0;
                    gameOver=false; timer=0;
                      firstClick=true;

                        gridEl.innerHTML="";
                          gridEl.style.gridTemplateColumns=`repeat(${size},1fr)`;

                            mines.textContent="üí£ "+minesCount;
                              time.textContent="‚è± 0";
                                face.textContent="üôÇ";

                                  for(let i=0;i<size*size;i++)
                                      grid.push({m:false,o:false,f:false,c:0});

                                        if(!levels[level].safe)
                                            placeMines(); // –¥–ª—è –ª—ë–≥–∫–æ–≥–æ ‚Äî —Å—Ä–∞–∑—É

                                              grid.forEach((_,i)=>{
                                                  const el=document.createElement("div");
                                                      el.className="cell";
                                                          addLongPress(el,i);
                                                              el.onclick=()=>openCell(i,el);
                                                                  el.oncontextmenu=e=>{e.preventDefault();toggleFlag(i,el);}
                                                                      gridEl.appendChild(el);
                                                                        });

                                                                          interval=setInterval(()=>{
                                                                              if(!gameOver) time.textContent="‚è± "+(++timer);
                                                                                },1000);
                                                                                }

                                                                                /* ‚õèÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–Ω —Å –∑–∞—â–∏—Ç–æ–π –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞ */
                                                                                function placeMines(excludeIndex){
                                                                                  let forbidden = excludeIndex!==undefined
                                                                                      ? getNeighbors(excludeIndex).concat(excludeIndex)
                                                                                          : [];

                                                                                            let placed=0;
                                                                                              while(placed<minesCount){
                                                                                                  let i=Math.random()*grid.length|0;
                                                                                                      if(grid[i].m) continue;
                                                                                                          if(forbidden.includes(i)) continue;
                                                                                                              grid[i].m=true;
                                                                                                                  placed++;
                                                                                                                    }

                                                                                                                      for(let i=0;i<grid.length;i++){
                                                                                                                          if(grid[i].m) continue;
                                                                                                                              grid[i].c = getNeighbors(i).filter(n=>grid[n].m).length;
                                                                                                                                }
                                                                                                                                }

                                                                                                                                function getNeighbors(i){
                                                                                                                                  const x=i%size,y=i/size|0,n=[];
                                                                                                                                    for(let dy=-1;dy<=1;dy++)
                                                                                                                                        for(let dx=-1;dx<=1;dx++){
                                                                                                                                              if(!dx&&!dy)continue;
                                                                                                                                                    let nx=x+dx,ny=y+dy;
                                                                                                                                                          if(nx>=0&&ny>=0&&nx<size&&ny<size)
                                                                                                                                                                  n.push(ny*size+nx);
                                                                                                                                                                      }
                                                                                                                                                                        return n;
                                                                                                                                                                        }

                                                                                                                                                                        function openCell(i,el){
                                                                                                                                                                          if(gameOver||grid[i].o||grid[i].f) return;

                                                                                                                                                                            if(firstClick && levels[level].safe){
                                                                                                                                                                                placeMines(i);
                                                                                                                                                                                    firstClick=false;
                                                                                                                                                                                      }

                                                                                                                                                                                        grid[i].o=true;
                                                                                                                                                                                          el.classList.add("open");
                                                                                                                                                                                            opened++;

                                                                                                                                                                                              if(grid[i].m){
                                                                                                                                                                                                  explode();
                                                                                                                                                                                                      return;
                                                                                                                                                                                                        }

                                                                                                                                                                                                          if(grid[i].c){
                                                                                                                                                                                                              el.textContent=grid[i].c;
                                                                                                                                                                                                                  el.classList.add("n"+grid[i].c);
                                                                                                                                                                                                                    }else{
                                                                                                                                                                                                                        getNeighbors(i).forEach(n=>{
                                                                                                                                                                                                                              openCell(n, gridEl.children[n]);
                                                                                                                                                                                                                                  });
                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                      if(opened === size*size - minesCount){
                                                                                                                                                                                                                                          gameOver=true;
                                                                                                                                                                                                                                              face.textContent="üòé";
                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                function explode(){
                                                                                                                                                                                                                                                  gameOver=true;
                                                                                                                                                                                                                                                    face.textContent="üòµ";
                                                                                                                                                                                                                                                      grid.forEach((c,i)=>{
                                                                                                                                                                                                                                                          if(c.m){
                                                                                                                                                                                                                                                                const el=gridEl.children[i];
                                                                                                                                                                                                                                                                      el.textContent="üí£";
                                                                                                                                                                                                                                                                            el.classList.add("mine","open");
                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                  });
                                                                                                                                                                                                                                                                                  }

                                                                                                                                                                                                                                                                                  /* üö© –§–ª–∞–≥: —É–¥–µ—Ä–∂–∞–Ω–∏–µ 1 —Å–µ–∫ */
                                                                                                                                                                                                                                                                                  function toggleFlag(i,el){
                                                                                                                                                                                                                                                                                    if(gameOver||grid[i].o) return;
                                                                                                                                                                                                                                                                                      grid[i].f = !grid[i].f;
                                                                                                                                                                                                                                                                                        el.textContent = grid[i].f ? "üö©" : "";
                                                                                                                                                                                                                                                                                          flags += grid[i].f ? 1 : -1;
                                                                                                                                                                                                                                                                                            mines.textContent="üí£ "+(minesCount-flags);
                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                            function addLongPress(el,i){
                                                                                                                                                                                                                                                                                              let timer;
                                                                                                                                                                                                                                                                                                el.onpointerdown=()=>{
                                                                                                                                                                                                                                                                                                    timer=setTimeout(()=>{
                                                                                                                                                                                                                                                                                                          toggleFlag(i,el);
                                                                                                                                                                                                                                                                                                              },700);
                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                  el.onpointerup=
                                                                                                                                                                                                                                                                                                                    el.onpointerleave=
                                                                                                                                                                                                                                                                                                                      el.onpointercancel=()=>{
                                                                                                                                                                                                                                                                                                                          clearTimeout(timer);
                                                                                                                                                                                                                                                                                                                            };
                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                            /* –ö–Ω–æ–ø–∫–∏ */
                                                                                                                                                                                                                                                                                                                            b1.onclick=()=>start(0);
                                                                                                                                                                                                                                                                                                                            b2.onclick=()=>start(1);
                                                                                                                                                                                                                                                                                                                            b3.onclick=()=>start(2);

                                                                                                                                                                                                                                                                                                                            start(0);
                                                                                                                                                                                                                                                                                                                            </script>

</body>
</html>

                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
